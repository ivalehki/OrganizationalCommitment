---
title: "ANALIZA"
output: html_document
date: "2025-11-30"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Učitavanje rezultata ankete

Funkcija koja mi označava mjesto u podacima za koje vrijedi filter koji unesem: Anketa[which(anketa$Spol) == 'a'), 'Spol'] - dakle, prvi dio uglate zagrade označava redove u kojima je upisana vrijednost a, a drugi dio uglade zagrade je označena kolona koju pretražujemo.
```{r }
library(readxl)
library(tidyverse)
library(patchwork)
Anketa <- read_excel("ANKETA_ODGOVORI.xlsx")



```

#Preimenovanje vrijednosti u kolonama
```{r}
Anketa[which(Anketa$Spol == 'a'), 'Spol'] = 'Muško'
Anketa[which(Anketa$Spol == 'b'), 'Spol'] = 'Žensko'
Anketa[which(Anketa$Dob == 'a'), 'Dob'] = '>=30'
Anketa[which(Anketa$Dob == 'b'), 'Dob'] = '31-40'
Anketa[which(Anketa$Dob == 'c'), 'Dob'] = '41-50'
Anketa[which(Anketa$Dob == 'd'), 'Dob'] = '>=51'
Anketa[which(Anketa$RadniStaž == 'a'), 'RadniStaž'] = '<=5'
Anketa[which(Anketa$RadniStaž == 'b'), 'RadniStaž'] = '6-10'
Anketa[which(Anketa$RadniStaž == 'c'), 'RadniStaž'] = '11-20'
Anketa[which(Anketa$RadniStaž == 'd'), 'RadniStaž'] = '>=21'
Anketa[which(Anketa$BračniStatus == 'a'), 'BračniStatus'] = 'Neoženjen/Neudata'
Anketa[which(Anketa$BračniStatus == 'b'), 'BračniStatus'] = 'Oženjen/Udata/Izvanbračna zajednica'
Anketa[which(Anketa$BračniStatus == 'c'), 'BračniStatus'] = 'Razveden/a'
Anketa[which(Anketa$BračniStatus == 'd'), 'BračniStatus'] = 'Udovac/Udovica'
Anketa[which(Anketa$Obrazovanje == 'a'), 'Obrazovanje'] = 'NKV'
Anketa[which(Anketa$Obrazovanje == 'b'), 'Obrazovanje'] = 'KV'
Anketa[which(Anketa$Obrazovanje == 'c'), 'Obrazovanje'] = 'SSS'
Anketa[which(Anketa$Obrazovanje == 'd'), 'Obrazovanje'] = 'VKV'
Anketa[which(Anketa$Obrazovanje == 'e'), 'Obrazovanje'] = 'VŠS'
Anketa[which(Anketa$Obrazovanje == 'f'), 'Obrazovanje'] = 'VSS'
Anketa[which(Anketa$Obrazovanje == 'g'), 'Obrazovanje'] = 'MR/DR'
Anketa[which(Anketa$RadnoMjesto == 'a'), 'RadnoMjesto'] = 'Izvršno'
Anketa[which(Anketa$RadnoMjesto == 'b'), 'RadnoMjesto'] = 'Rukovodeće'
Anketa[which(Anketa$VrstaPosla == 'c'), 'VrstaPosla'] = 'Određeno'
Anketa[which(Anketa$VrstaPosla == 'd'), 'VrstaPosla'] = 'Neodređeno'

```

# DISTRIBUCIJA SPOLA ISPITANIKA
```{r}
P1 = ggplot(Anketa, aes(x=Spol, fill = Spol))+
  geom_bar(stat='count') +
  scale_fill_manual(values = c('Muško' = '#103778', 'Žensko' = '#FF7A48')) +
  theme_minimal()+
  ylab('Broj ispitanika')

ggsave('Tablica1.png', P1)
```

### DISTRIBUCIJA GODINA ISPITANIKA
```{r, echo=FALSE}
P2 = ggplot(Anketa, aes(x=Dob)) +
  geom_bar(stat='count', fill = '#151F30') +
  theme_minimal() + 
  ylab('Broj ispitanika')

ggsave('Tablica2.png', P2 )

```
### DISTRIBUCIJA RADNOG STAŽA ISPITANIKA
```{r}
P3 = ggplot(Anketa, aes(x=RadniStaž)) +
  geom_bar(stat='count', fill = '#151F30') +
  theme_minimal() +
  ylab('Broj ispitanika') + 
  xlab('Radni Staž')

P3
ggsave('Tablica3.png', P3)
```

### DISTIRBUCIJA OBRAZOVANJA ISPITANIKA

```{r}
P4 = ggplot(Anketa, aes(x=Obrazovanje)) +
  geom_bar(stat='count', fill = '#151F30') +
  theme_minimal() +
  ylab('Broj ispitanika')

P4

```

### DISTRIBUCIJA DEMOGRAFSKIH POKAZATELJA ISPITANIKA

```{r}
P1 + P2 + P3 + P4
ggsave('Tablica_demografija_part1.png', P1 + P2 + P3 + P4 )
```



### DISTRIBUCIJA BRAČNOG STATUSA ISPITANIKA
```{r}
P5 = ggplot(Anketa, aes(x=BračniStatus, fill=BračniStatus)) + 
  geom_bar(stat = 'count') +
  theme_minimal() +
  ylab('Broj ispitanika') + 
  xlab('Bračni status') + 
  scale_fill_manual(values = c('Neoženjen/Neudata' = '#151F30', 'Oženjen/Udata/Izvanbračna zajednica' = '#103778', 'Razveden/a' = '#0593A2', 'Udovac/Udovica' = '#FF7A48'))

P5
ggsave('Tablica4.png', P5)
```

### DISTRIBUCIJA RADNOG MJESTA ISPITANIKA
```{r}
P6 = ggplot (Anketa, aes(x=RadnoMjesto)) +
  geom_bar(stat = 'count', fill = '#151F30') + 
  theme_minimal() +
  ylab('Broj ispitanika') +
  xlab('Radno mjesto')

P6
```

### DISTRIBUCIJA VRSTE POSLA ISPITANIKA

```{r}
P7 = ggplot(Anketa, aes(x=VrstaPosla)) +
  geom_bar(stat = 'count', fill = '#151F30') +
  theme_minimal() +
  ylab('Broj ispitanika') +
  xlab('Vrsta posla') 

P7
```

### DISTRIBUCIJA DEMOGRAFSKIH POKAZATELJA ISPITANIKA PART 2

```{r}
P5 + P6 + P7
ggsave('Tablica_demografija_part2.png', P5 / (P6 + P7), height = 8, width = 12)
```


