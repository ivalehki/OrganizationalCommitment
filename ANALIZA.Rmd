---
title: "ANALIZA"
output: html_document
date: "2025-11-30"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Učitavanje rezultata ankete

Funkcija koja mi označava mjesto u podacima za koje vrijedi filter koji unesem: Anketa[which(anketa$Spol) == 'a'), 'Spol'] - dakle, prvi dio uglate zagrade označava redove u kojima je upisana vrijednost a, a drugi dio uglate zagrade je označena kolona koju pretražujemo.
```{r }
library(readxl)
library(tidyverse)
library(patchwork)
Anketa <- read_excel("ANKETA_ODGOVORI.xlsx")



```

#Preimenovanje vrijednosti u kolonama
```{r}
Anketa[which(Anketa$Spol == 'a'), 'Spol'] = 'Muško'
Anketa[which(Anketa$Spol == 'b'), 'Spol'] = 'Žensko'
Anketa[which(Anketa$Dob == 'a'), 'Dob'] = '>=30'
Anketa[which(Anketa$Dob == 'b'), 'Dob'] = '31-40'
Anketa[which(Anketa$Dob == 'c'), 'Dob'] = '41-50'
Anketa[which(Anketa$Dob == 'd'), 'Dob'] = '>=51'
Anketa[which(Anketa$RadniStaž == 'a'), 'RadniStaž'] = '<=5'
Anketa[which(Anketa$RadniStaž == 'b'), 'RadniStaž'] = '6-10'
Anketa[which(Anketa$RadniStaž == 'c'), 'RadniStaž'] = '11-20'
Anketa[which(Anketa$RadniStaž == 'd'), 'RadniStaž'] = '>=21'
Anketa[which(Anketa$BračniStatus == 'a'), 'BračniStatus'] = 'Neoženjen/Neudata'
Anketa[which(Anketa$BračniStatus == 'b'), 'BračniStatus'] = 'Oženjen/Udata/Izvanbračna zajednica'
Anketa[which(Anketa$BračniStatus == 'c'), 'BračniStatus'] = 'Razveden/a'
Anketa[which(Anketa$BračniStatus == 'd'), 'BračniStatus'] = 'Udovac/Udovica'
Anketa[which(Anketa$Obrazovanje == 'a'), 'Obrazovanje'] = 'NKV'
Anketa[which(Anketa$Obrazovanje == 'b'), 'Obrazovanje'] = 'KV'
Anketa[which(Anketa$Obrazovanje == 'c'), 'Obrazovanje'] = 'SSS'
Anketa[which(Anketa$Obrazovanje == 'd'), 'Obrazovanje'] = 'VKV'
Anketa[which(Anketa$Obrazovanje == 'e'), 'Obrazovanje'] = 'VŠS'
Anketa[which(Anketa$Obrazovanje == 'f'), 'Obrazovanje'] = 'VSS'
Anketa[which(Anketa$Obrazovanje == 'g'), 'Obrazovanje'] = 'MR/DR'
Anketa[which(Anketa$RadnoMjesto == 'a'), 'RadnoMjesto'] = 'Izvršno'
Anketa[which(Anketa$RadnoMjesto == 'b'), 'RadnoMjesto'] = 'Rukovodeće'
Anketa[which(Anketa$VrstaPosla == 'c'), 'VrstaPosla'] = 'Određeno'
Anketa[which(Anketa$VrstaPosla == 'd'), 'VrstaPosla'] = 'Neodređeno'

```

KOLOR PALETA SE ZOVE WATER & RUST
#151F30 (TAMNO PLAVA), #103778 (SVJETLIJE PLAVA), #0593A2 (SVIJETLO PLAVA), #FF4F16 (NARANČASTA), #E3371E (CIGLENO CRVENA) 



# DISTRIBUCIJA SPOLA ISPITANIKA
```{r}
P1 = ggplot(Anketa, aes(x=Spol, fill = Spol))+
  geom_bar(stat='count') +
  scale_fill_manual(values = c('Muško' = '#103778', 'Žensko' = '#FF7A48')) +
  theme_minimal()+
  ylab('Broj ispitanika')

ggsave('Tablica1.png', P1)
```

### DISTRIBUCIJA GODINA ISPITANIKA
```{r, echo=FALSE}
P2 = ggplot(Anketa, aes(x=Dob)) +
  geom_bar(stat='count', fill = '#151F30') +
  theme_minimal() + 
  ylab('Broj ispitanika')

ggsave('Tablica2.png', P2 )

```
### DISTRIBUCIJA RADNOG STAŽA ISPITANIKA
```{r}
P3 = ggplot(Anketa, aes(x=RadniStaž)) +
  geom_bar(stat='count', fill = '#151F30') +
  theme_minimal() +
  ylab('Broj ispitanika') + 
  xlab('Radni Staž')

P3
ggsave('Tablica3.png', P3)
```

### DISTIRBUCIJA OBRAZOVANJA ISPITANIKA

```{r}
P4 = ggplot(Anketa, aes(x=Obrazovanje)) +
  geom_bar(stat='count', fill = '#151F30') +
  theme_minimal() +
  ylab('Broj ispitanika')

P4

```

### DISTRIBUCIJA DEMOGRAFSKIH POKAZATELJA ISPITANIKA

```{r}
P1 + P2 + P3 + P4
ggsave('Tablica_demografija_part1.png', P1 + P2 + P3 + P4 )
```



### DISTRIBUCIJA BRAČNOG STATUSA ISPITANIKA
```{r}
P5 = ggplot(Anketa, aes(x=BračniStatus, fill=BračniStatus)) + 
  geom_bar(stat = 'count') +
  theme_minimal() +
  ylab('Broj ispitanika') + 
  xlab('Bračni status') + 
  scale_fill_manual(values = c('Neoženjen/Neudata' = '#151F30', 'Oženjen/Udata/Izvanbračna zajednica' = '#103778', 'Razveden/a' = '#0593A2', 'Udovac/Udovica' = '#FF7A48'))

P5
ggsave('Tablica4.png', P5)
```

### DISTRIBUCIJA RADNOG MJESTA ISPITANIKA
```{r}
P6 = ggplot (Anketa, aes(x=RadnoMjesto)) +
  geom_bar(stat = 'count', fill = '#151F30') + 
  theme_minimal() +
  ylab('Broj ispitanika') +
  xlab('Radno mjesto')

P6
```

### DISTRIBUCIJA VRSTE POSLA ISPITANIKA

```{r}
P7 = ggplot(Anketa, aes(x=VrstaPosla)) +
  geom_bar(stat = 'count', fill = '#151F30') +
  theme_minimal() +
  ylab('Broj ispitanika') +
  xlab('Vrsta posla') 

P7
```

### DISTRIBUCIJA DEMOGRAFSKIH POKAZATELJA ISPITANIKA PART 2

```{r}
P5 + P6 + P7
ggsave('Tablica_demografija_part2.png', P5 / (P6 + P7), height = 8, width = 12)
```

### ANALIZA INDIVIDUALNIH ODGOVORA ISPITANIKA (PROSJEK/MEAN, SETOVI PITANJA - AFEKTIVNE KOMPONENTE)
```{r}
ggplot(Anketa)+
 stat_summary( aes(x ='1. Bio/la bih jako sretan/na kada bih proveo/la ostatak karijere u tvrtki u kojoj radim.', y=`8`), fun = "mean", geom = "bar", fill = '#103778' ) +
 stat_summary( aes(x ='2. Zaista osjećam da su problemi koje ima moja tvrtka ujedno i moji problemi.', y=`9`), fun = "mean", geom = "bar", fill = '#103778' ) +
 stat_summary( aes(x ='3. Osjećam se kao „dio obitelji“ u ovoj tvrtki.', y=`10`), fun = "mean", geom = "bar", fill = '#103778' ) +
 stat_summary( aes(x ='4. Osjećam emocionalnu povezanost prema svojoj tvrtki.', y=`11`), fun = "mean", geom = "bar", fill = '#103778' ) +
 stat_summary( aes(x ='5. Ova tvrtka ima veliko osobno značenje za mene.', y=`12`), fun = "mean", geom = "bar", fill = '#103778' ) +
 stat_summary( aes(x ='6. Imam snažan osjećaj da pripadam tvrtki u kojoj radim.', y=`13`), fun = "mean", geom = "bar", fill = '#103778') +
 theme_minimal() + 
 coord_flip()+
 xlab("") + 
 ylab("Prosječna ocjena")
 

```


###### ANALIZA INDIVIDUALNIH ODGOVORA ISPITANIKA (PROSJEK/MEAN, SETOVI PITANJA - KONTINUIRANE KOMPONENTE)

```{r}
ggplot(Anketa)+
 stat_summary( aes(x ='7. Bilo bi mi jako teško (nezgodno) sada napustiti posao, čak i kada bi mi to bila želja. ', y=`14`), fun = "mean", geom = "bar", fill = '#FF7A48' ) +
 stat_summary( aes(x ='8. Previše bi mi se toga u životu poremetilo kada bih otišao iz svoje tvrtke.', y=`15`), fun = "mean", geom = "bar", fill = '#FF7A48' ) +
 stat_summary( aes(x ='9. Trenutačno je razlog moga ostanka u tvrtki stvar nužnosti koliko i želje.', y=`16`), fun = "mean", geom = "bar", fill = '#FF7A48' ) +
 stat_summary( aes(x ='10. Smatram da imam premalo drugih mogućnosti da bih razmatrao/la o odlasku iz tvrtke.', y=`17`), fun = "mean", geom = "bar", fill = '#FF7A48' ) +
 stat_summary( aes(x ='11. Jedna od nekoliko negativnih posljedica napuštanja posla u tvrtki će biti mala mogućnost za pronaći posao negdje drugdje.', y=`18`), fun = "mean", geom = "bar", fill = '#FF7A48' ) +
 stat_summary( aes(x ='12. Jedan od glavnih razloga što ću nastaviti raditi u ovoj tvrtki je taj što bi odlazak zahtijevao previše osobnog žrtvovanja.', y=`19`), fun = "mean", geom = "bar", fill = '#FF7A48') +
 theme_minimal() + 
 coord_flip()+
 xlab("") + 
 ylab("Prosječna ocjena")
```

### RAČUNANJE PROSJEČNIH VRIJEDNOSTI PO PITANJIMA IZ SETA KONTINUIRANE PREDANOSTI
```{r}
cat( "7." ,mean(Anketa$`14`))
cat( "8." ,mean(Anketa$`15`) )
cat( "9." ,mean(Anketa$`16`))
cat( "10." ,mean(Anketa$`17`))
cat( "11." ,mean(Anketa$`18`))
cat( "12." ,mean(Anketa$`19`))
```


### RAČUNANJE PROSJEČNIH VRIJEDNOSTI PO PITANJIMA IZ SETA AFEKTIVNE PREDANOSTI
```{r}
cat( "1." ,mean(Anketa$`8`))
cat( "2." ,mean(Anketa$`9`) )
cat( "3." ,mean(Anketa$`10`))
cat( "4." ,mean(Anketa$`11`))
cat( "5." ,mean(Anketa$`12`))
cat( "6." ,mean(Anketa$`13`))
```

### RAČUNANJE PROSJEČNOG STUPNJA SLAGANJA ISPITANIKA PO KOMPONENTAMA (AF, NORM, KONT)  
```{r}
Anketa[,'AF_rez'] = rowMeans(Anketa[,c(8:13)])
Anketa[, 'Kont_rez']= rowMeans(Anketa[, c(14:19)])
Anketa[, 'Norm_rez']= rowMeans(Anketa[,c(20:25)])
```

### USPOREDBA PROSJEČNIH STUPNJEVA SLAGANJA PO DEMOGRAFIJI

```{r}
library (ggpubr) 
hist(Anketa$AF_rez)

ggplot(Anketa, aes(x=Spol, y=AF_rez, fill=Spol))+
  geom_boxplot()+
  stat_compare_means(method = 't.test')+
  theme_minimal()+
ylab('Stupanj afektivne predanosti')+
scale_fill_manual(values = c('Muško'='#151F30', 'Žensko'='#FF7A48'))
```

### USPOREDBA PROSJEČNIH STUPNJEVA SLAGANJA PREMA RADNOM MJESTU

```{r}
library(ggpubr)
hist(Anketa$RadnoMjesto)

ggplot(Anketa, aes(x=RadnoMjesto, y=Kont_rez, fill =RadnoMjesto))+
  geom_boxplot()+
  geom_point()+
  stat_compare_means(method = 't.test')+
  theme_minimal()+
ylab('Stupanj afektivne predanosti')+
scale_fill_manual(values = c('Izvršno'='#103778', 'Rukovodeće'='#0593A2'))

```

